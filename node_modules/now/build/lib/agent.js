"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _stringify=require("babel-runtime/core-js/json/stringify"),_stringify2=_interopRequireDefault(_stringify),_typeof2=require("babel-runtime/helpers/typeof"),_typeof3=_interopRequireDefault(_typeof2),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_nodeFetch=require("node-fetch"),_nodeFetch2=_interopRequireDefault(_nodeFetch),Agent=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=n.debug;(0,_classCallCheck3["default"])(this,e),this._host=t,this._debug=r,this._initAgent()}return(0,_createClass3["default"])(e,[{key:"_initAgent",value:function(){}},{key:"_onError",value:function(e){this._debug&&console.log("> [debug] agent connection error",e.stack),this._error=e}},{key:"fetch",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this._error&&(this._debug&&console.log("> [debug] re-initializing agent after error"),this._error=null,this._initAgent());var n=t.body;return n&&"object"===("undefined"==typeof n?"undefined":(0,_typeof3["default"])(n))&&"function"!=typeof n.pipe&&(t.headers["Content-Type"]="application/json",t.body=(0,_stringify2["default"])(n)),null!=t.body&&"function"!=typeof n.pipe&&(t.headers["Content-Length"]=Buffer.byteLength(t.body)),(0,_nodeFetch2["default"])("https://"+this._host+e,t)}},{key:"close",value:function(){this._debug&&console.log("> [debug] closing agent")}}]),e}();exports["default"]=Agent;